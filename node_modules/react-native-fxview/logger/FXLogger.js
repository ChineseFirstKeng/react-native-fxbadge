"use strict";
/* eslint-disable @typescript-eslint/no-explicit-any */
// ========== Logger ç±»å‹å®šä¹‰ ==========
Object.defineProperty(exports, "__esModule", { value: true });
exports.FXLogger = exports.FXLogLevel = void 0;
/**
 * æ—¥å¿—çº§åˆ«æšä¸¾
 */
var FXLogLevel;
(function (FXLogLevel) {
    FXLogLevel[FXLogLevel["DEBUG"] = 0] = "DEBUG";
    FXLogLevel[FXLogLevel["INFO"] = 1] = "INFO";
    FXLogLevel[FXLogLevel["WARN"] = 2] = "WARN";
    FXLogLevel[FXLogLevel["ERROR"] = 3] = "ERROR";
    FXLogLevel[FXLogLevel["SILENT"] = 4] = "SILENT";
})(FXLogLevel || (exports.FXLogLevel = FXLogLevel = {}));
/**
 * FX Logger - ä¸“ä¸º React Native é¡¹ç›®è®¾è®¡çš„è°ƒè¯•æ—¥å¿—ç³»ç»Ÿ
 * æä¾›ä¸°å¯Œçš„æ—¥å¿—åŠŸèƒ½å’Œçµæ´»çš„é…ç½®é€‰é¡¹
 */
class FXLogger {
    /**
     * ç§æœ‰æ„é€ å‡½æ•°ï¼Œå®ç°å•ä¾‹æ¨¡å¼
     */
    constructor() {
        // è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒ
        const isDevelopment = this.isDevelopmentEnvironment();
        // æ ¹æ®ç¯å¢ƒè®¾ç½®é»˜è®¤é…ç½®
        this.config = {
            debug: isDevelopment, // å¼€å‘ç¯å¢ƒå¯ç”¨è°ƒè¯•æ¨¡å¼ï¼Œç”Ÿäº§ç¯å¢ƒç¦ç”¨
            level: isDevelopment ? FXLogLevel.DEBUG : FXLogLevel.ERROR, // ç”Ÿäº§ç¯å¢ƒåªæ˜¾ç¤ºé”™è¯¯æ—¥å¿—
            showTimestamp: true,
            prefix: isDevelopment ? "[FX-DEV]" : "[FX-PROD]", // ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒå‰ç¼€
        };
    }
    /**
     * è·å–å•ä¾‹å®ä¾‹
     */
    static getInstance() {
        if (!FXLogger.instance) {
            FXLogger.instance = new FXLogger();
        }
        return FXLogger.instance;
    }
    /**
     * æ£€æµ‹å½“å‰æ˜¯å¦ä¸ºå¼€å‘ç¯å¢ƒ
     */
    isDevelopmentEnvironment() {
        try {
            // ä½¿ç”¨ Function æ„é€ å‡½æ•°æ¥å®‰å…¨åœ°è®¿é—®å…¨å±€å˜é‡ï¼Œé¿å… TypeScript é”™è¯¯
            const getGlobal = new Function("return this")();
            // æ£€æµ‹ React Native çš„ __DEV__ å˜é‡
            if (typeof getGlobal.__DEV__ !== "undefined" && getGlobal.__DEV__) {
                return true;
            }
            // æ£€æµ‹ Node.js ç¯å¢ƒå˜é‡
            if (typeof getGlobal.process !== "undefined" &&
                getGlobal.process.env &&
                getGlobal.process.env.NODE_ENV === "development") {
                return true;
            }
            // æ£€æµ‹ window å¯¹è±¡ï¼ˆæµè§ˆå™¨ç¯å¢ƒï¼‰
            if (typeof getGlobal.window !== "undefined" && getGlobal.window.__DEV__) {
                return true;
            }
            // æ£€æµ‹å…¨å±€å¯¹è±¡å±æ€§
            if (getGlobal.NODE_ENV === "development") {
                return true;
            }
        }
        catch (error) {
            // å¦‚æœæ£€æµ‹è¿‡ç¨‹ä¸­å‡ºé”™ï¼Œé»˜è®¤è¿”å› falseï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
            this.error("Environment detection failed", error);
        }
        // é»˜è®¤è¿”å› falseï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
        return false;
    }
    /**
     * è·å–å½“å‰é…ç½®
     */
    getConfig() {
        return Object.assign({}, this.config);
    }
    /**
     * é…ç½® Logger
     */
    configure(config) {
        this.config = Object.assign(Object.assign({}, this.config), config);
    }
    /**
     * å¯ç”¨è°ƒè¯•æ¨¡å¼
     */
    enableDebug() {
        this.config.debug = true;
    }
    /**
     * ç¦ç”¨è°ƒè¯•æ¨¡å¼
     */
    disableDebug() {
        this.config.debug = false;
    }
    /**
     * è·å–æ—¶é—´æˆ³ï¼ˆåŒ…å«å¹´æœˆæ—¥ï¼‰
     */
    getTimestamp() {
        const now = new Date();
        const year = now.getFullYear();
        const month = (now.getMonth() + 1).toString().padStart(2, "0");
        const day = now.getDate().toString().padStart(2, "0");
        const hours = now.getHours().toString().padStart(2, "0");
        const minutes = now.getMinutes().toString().padStart(2, "0");
        const seconds = now.getSeconds().toString().padStart(2, "0");
        const milliseconds = now.getMilliseconds().toString().padStart(3, "0");
        return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}.${milliseconds}`;
    }
    /**
     * æ£€æŸ¥æ˜¯å¦åº”è¯¥è®°å½•æ—¥å¿—
     */
    shouldLog(level) {
        if (!this.config.debug && level < FXLogLevel.ERROR) {
            return false;
        }
        return level >= this.config.level;
    }
    /**
     * è·å–æ—¥å¿—çº§åˆ«çš„é¢œè‰²ç¬¦å·
     */
    getLevelColor(level) {
        switch (level) {
            case FXLogLevel.DEBUG:
                return "ğŸ”µ"; // è“è‰² - è°ƒè¯•
            case FXLogLevel.INFO:
                return "ğŸŸ¢"; // ç»¿è‰² - ä¿¡æ¯
            case FXLogLevel.WARN:
                return "ğŸŸ¡"; // é»„è‰² - è­¦å‘Š
            case FXLogLevel.ERROR:
                return "ğŸ”´"; // çº¢è‰² - é”™è¯¯
            default:
                return "âšª"; // é»˜è®¤ç™½è‰²
        }
    }
    /**
     * æ ¼å¼åŒ–æ—¥å¿—æ¶ˆæ¯
     */
    formatMessage(level, message) {
        const parts = [];
        if (this.config.prefix) {
            parts.push(this.config.prefix);
        }
        if (this.config.showTimestamp) {
            parts.push(`[${this.getTimestamp()}]`);
        }
        // æ ¹æ®æ—¥å¿—çº§åˆ«æ·»åŠ é¢œè‰²ç¬¦å·
        const levelEnum = FXLogLevel[level.toUpperCase()];
        const colorSymbol = this.getLevelColor(levelEnum);
        parts.push(`[${colorSymbol}${level.toUpperCase()}]`);
        return parts.join("") + " " + message;
    }
    /**
     * è°ƒè¯•æ—¥å¿—
     */
    log(message, ...optionalParams) {
        if (!this.shouldLog(FXLogLevel.DEBUG))
            return;
        const formattedMessage = this.formatMessage("debug", message);
        console.log(formattedMessage, ...optionalParams);
    }
    /**
     * ä¿¡æ¯æ—¥å¿—
     */
    info(message, ...optionalParams) {
        if (!this.shouldLog(FXLogLevel.INFO))
            return;
        const formattedMessage = this.formatMessage("info", message);
        console.info(formattedMessage, ...optionalParams);
    }
    /**
     * è­¦å‘Šæ—¥å¿—
     */
    warn(message, ...optionalParams) {
        if (!this.shouldLog(FXLogLevel.WARN))
            return;
        const formattedMessage = this.formatMessage("warn", message);
        console.warn(formattedMessage, ...optionalParams);
    }
    /**
     * é”™è¯¯æ—¥å¿—
     */
    error(message, ...optionalParams) {
        if (!this.shouldLog(FXLogLevel.ERROR))
            return;
        const formattedMessage = this.formatMessage("error", message);
        console.error(formattedMessage, ...optionalParams);
    }
    /**
     * è¿½è¸ªæ—¥å¿—
     */
    trace(message, ...optionalParams) {
        if (!this.shouldLog(FXLogLevel.DEBUG))
            return;
        const formattedMessage = this.formatMessage("trace", message);
        console.trace(formattedMessage, ...optionalParams);
    }
    /**
     * è¡¨æ ¼æ—¥å¿—
     */
    table(...data) {
        if (!this.shouldLog(FXLogLevel.DEBUG))
            return;
        console.table(...data);
    }
    /**
     * åˆ†ç»„æ—¥å¿—
     */
    group(label) {
        if (!this.shouldLog(FXLogLevel.DEBUG))
            return;
        console.group(label);
    }
    /**
     * ç»“æŸåˆ†ç»„æ—¥å¿—
     */
    groupEnd() {
        console.groupEnd();
    }
    /**
     * æŠ˜å åˆ†ç»„æ—¥å¿—
     */
    groupCollapsed(label) {
        if (!this.shouldLog(FXLogLevel.DEBUG))
            return;
        console.groupCollapsed(label);
    }
}
exports.FXLogger = FXLogger;
// åˆ›å»ºå…¨å±€å®ä¾‹
const logger = FXLogger.getInstance();
// å¯¼å‡ºé»˜è®¤å®ä¾‹
exports.default = logger;
